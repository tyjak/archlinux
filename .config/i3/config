# app to start on launch i3
exec_always compton -f

# start a concole if not starting
exec [ $(pgrep -f '[a]lacritty --title terminal) ] && alacritty --title terminal

# special keys
set $mod Mod4
set $capsLock Mode_switch

# fix floating windows size
# medium size
set $wfS_height 400
set $wfS_width 600
# medium size
set $wfM_height 500
set $wfM_width 800
# big size
set $wfL_height 600
set $wfL_width 1000
# layout mode for new container
workspace_layout tabbed

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below. ISO 10646 = Unicode
# font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
# The font above is very space-efficient, that is, it looks good, sharp and
# clear in small sizes. However, if you need a lot of unicode glyphs or
# right-to-left text rendering, you should instead use pango for rendering and
# chose a FreeType font, such as:
font pango:Meslo LG S DZ, icons, FontAwesome, Devicons, 10

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# start a terminal
bindsym $mod+Return exec i3-sensible-terminal;
bindsym $mod+Shift+Return layout splith; exec i3-sensible-terminal;

# kill focused window
bindsym $mod+Shift+q kill

# mark current win
bindsym $mod+Shift+n mark working
# switch tp mark
bindsym $mod+n [con_mark="working"] focus

# start dmenu (a program launcher)
bindsym $mod+d exec dmenu_run -i -nb '#859900' -nf '#eee8d5' -sb '#cb4b16' -fn 'MesloLGSDZ Nerd Font-10' -h 24
bindsym $mod+c exec clipmenu -i -nb '#2aa198' -nf '#eee8d5' -sb '#cb4b16' -fn 'MesloLGSDZ Nerd Font-10' -h 24
#bindsym $mod+x exec PASSWORD_STORE_X_SELECTION=secondary passmenu -i -nb '#002b24' -nf '#eee8d5' -sb '#b58900' -fn 'MesloLGSDZ Nerd Font-10' -h 24 && xsel -o -s | xdotool type --file -
bindsym $mod+x exec "PASSWORD_STORE_GENERATED_LENGTH=20 passdmenu -G -x s -P -f '^((?!work/jobintree|deprecated).)*$' --type -D ~/share/bin/mypassdmenu"
bindsym $mod+Shift+x exec "PASSWORD_STORE_GENERATED_LENGTH=20 passdmenu -G -u -x p,s -P -f '^((?!work/jobintree|deprecated).)*$' --type -D ~/share/bin/mypassdmenu"
bindsym $mod+s exec quickswitch -w -d "dmenu -i -nb '#eee8d5' -nf '#002b24' -sb '#859900' -fn 'MesloLGSDZ Nerd Font-10' -h 24"
bindsym $mod+Shift+s exec quickswitch -w -j -f -d "dmenu -i -nb '#eee8d5' -nf '#002b36' -sb '#859900' -fn 'MesloLGSDZ Nerd Font-10' -h 24"
bindsym $capsLock+Tab exec quickswitch -s -d "dmenu -l 10 -i -nb '#eee8d5' -nf '#002b36' -sb '#859900' -fn 'MesloLGSDZ Nerd Font-10' -h 24"
bindsym $mod+t exec "dict -d fd-eng-fra $(xclip -o) | tail +4 | dmenu -i -nb '#eee8d5' -nf '#002b36' -sb '#859900' -fn 'MesloLGSDZ Nerd Font-10' -h 24"
bindsym $mod+Shift+t exec "dict -d fd-fra-eng $(xclip -o) | tail +4 | dmenu -i -nb '#eee8d5' -nf '#002b36' -sb '#859900' -fn 'MesloLGSDZ Nerd Font-10' -h 24"
bindsym $mod+y exec dmenu-webnav
bindsym $mod+i exec dmenu-ssh
bindsym $mod+p exec dmenu-gist $(tty)
bindsym $capsLock+q exec qrcode
bindsym $capsLock+c exec cryptoinfoweb
# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
# bindsym $mod+d exec --no-startup-id i3-dmenu-desktop

# english dictionary
bindsym $mod+Shift+d exec "export D_DICT_DB_OPT='-d english'; ~/share/bin/dict_lookup"

# search for selection on the web
bindsym $mod+g exec /usr/bin/vimb "$(xclip -o)"

focus_follows_mouse no

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
#bindsym $mod+Left focus left
#bindsym $mod+Down focus down
#bindsym $mod+Up focus up
#bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# alternatively, you can use the cursor keys:
#bindsym $mod+Shift+Left move left
#bindsym $mod+Shift+Down move down
#bindsym $mod+Shift+Up move up
#bindsym $mod+Shift+Right move right

# cycle throw workspace
bindsym $mod+Tab workspace next
bindsym $mod+Shift+Tab workspace prev
bindsym $mod+Shift+Left workspace prev
bindsym $mod+Shift+Right workspace next

# split in horizontal orientation
bindsym $mod+Shift+v split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# change container layout (stacked, tabbed, toggle split)
# bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout splith

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# sticky window
#bindsym $mod+Shift+s sticky toggle
# focus the child container
#bindsym $mod+d focus child

bindsym $mod+Up move workspace to output up
bindsym $mod+Down move workspace to output down
bindsym $mod+Left move workspace to output left
bindsym $mod+Right move workspace to output right

#icon
set $vimIcon 

#menu title
set $menu1 1: terminal
set $menu2 2: web
set $menu3 3:
set $menu4 4: gmail
set $menu5 5:
set $menu6 6:
set $menu7 7:
set $menu8 8:<span background="#0000FF">AOAO</span>

#TODO: var does not seem to work in exec command
#set $chrome /usr/bin/brave

# switch to workspace
bindsym $mod+1 workspace $menu1; exec [ $(pgrep -f "alacritty --title terminal") ] && alacritty --title terminal
#bindsym $mod+1 workspace $menu1; exec [ $( ps -eo cmd | grep -c '[a]lacritty --title terminal' ) -eq 0 ] && alacritty --title terminal
bindsym $mod+2 workspace $menu2; mark web; exec [ $(pgrep -f "vimb") ] && /usr/bin/vimb
bindsym $mod+3 workspace $menu3; exec [ $(pgrep -f "alacritty --title uvim") ] && alacritty --title uvim -e vim
#bindsym $mod+4 workspace $menu4; layout tabbed; exec [ $( ps -eo cmd | grep -c '[u]rxvt -title muttgmail -e mutt' ) -eq 2 ] && urxvt -title muttgmail -e mutt -e "source ~/.mutt/gmail.com"
bindsym $mod+4 workspace $menu4; exec [ $(pgrep -f "alacritty --title mail-gmail") ] && alacritty --title mail-gmail -e /usr/bin/mutt -e "source ~/.mutt/gmail.com"
bindsym $mod+5 workspace $menu5; exec [ $(pgrep -f "brave") ] && /usr/bin/brave; move workspace to output $screen2
bindsym $mod+6 workspace $menu6; exec ~/share/bin/i3/photos
bindsym $mod+7 workspace $menu7; exec ~/share/bin/i3/firefox
#bindsym $mod+5 workspace $menu5; exec [ $( ps -eo cmd | grep -c '[t]ermite --title muttperso' ) -eq 2 ] && alacritty --title muttperso -e '/usr/bin/mutt -e "source ~/.mutt/newmanity.com"'
#bindsym $mod+6 workspace $menu6; exec [ $( ps -eo cmd | grep -c '[t]ermite --title muttjit' ) -eq 2 ] && alacritty --title muttjit -e '/usr/bin/mutt -e "source ~/.mutt/jobintree.com"'
#bindsym $mod+7 workspace $menu7; exec [ $( ps -eo cmd | grep -c '[u]rxvt -title tmux-weechat -e ssh -t david@do.tyjak.net LANG=fr_FR.UTF-8 tmux a -t weechat' ) -eq 2 ] && urxvt -title tmux-weechat -e ssh -t david@do.tyjak.net LANG=fr_FR.UTF-8 tmux a -t weechat
bindsym $mod+8 workspace $menu8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $menu1
bindsym $mod+Shift+2 move container to workspace $menu2
bindsym $mod+Shift+3 move container to workspace $menu3
bindsym $mod+Shift+4 move container to workspace $menu4
bindsym $mod+Shift+5 move container to workspace $menu5
bindsym $mod+Shift+6 move container to workspace $menu6
bindsym $mod+Shift+7 move container to workspace $menu7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10


# Use pactl to adjust volume in PulseAudio.
set $refresh_i3status killall -SIGUSR1 i3status
bindsym $mod+XF86AudioMute exec apptoggle pavucontrol
bindsym XF86AudioRaiseVolume exec --no-startup-id pamixer -i 2 && $refresh_i3status
bindsym XF86AudioLowerVolume exec --no-startup-id pamixer -d 2  && $refresh_i3status
bindsym XF86AudioMute exec --no-startup-id pamixer -t && $refresh_i3status
bindsym XF86AudioMicMute exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status
# mpd control by media keys
bindsym XF86AudioPlay exec "~/share/bin/xf86audio toggle"
bindsym XF86AudioPrev exec "~/share/bin/xf86audio prev"
bindsym XF86AudioNext exec "~/share/bin/xf86audio next"
bindsym XF86AudioForward exec "~/share/bin/xf86audio forw"
bindsym XF86AudioRewind exec "~/share/bin/xf86audio back"
#bindsym XF86AudioNext exec --no-startup-id mpc next
#bindsym XF86AudioPrev exec --no-startup-id mpc prev
#bindsym XF86AudioPlay exec --no-startup-id mpc toggle


#pb authorisation
#bindsym XF86MonBrightnessDown   exec xbacklight -dec 5 && pkill -RTMIN+20 i3blocks
#bindsym XF86MonBrightnessUp     exec xbacklight -inc 5 && pkill -RTMIN+20 i3blocks

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
  #font pango:FuraCode Nerd Font, 10
  font pango:Meslo LG S DZ, forkawesome, icomoon,  10
  status_command python ~/.config/i3/status.py
  #status_command ~/.virtualenvs/i3pystatus/bin/python ~/.config/i3/status.py
  #status_command ~/.virtualenvs/i3pystatus/bin/python ~/.config/i3/status-pulseaudio-dev.py
  position top
  #separator_symbol "┃"
  separator_symbol "│"
  strip_workspace_numbers yes
  colors {
    separator #586e75
    background #002b36
    statusline #93a1a1
    focused_workspace #eee8d5 #859900 #eee8d5
    active_workspace #fdf6e3 #6c71c4 #fdf6e3
    inactive_workspace #073642 #eee8d5 #002b36
    urgent_workspace #d33682 #d33682 #fdf6e3
    binding_mode #d33682 #d33682 #fdf6e3 
    }
}

hide_edge_borders both

#scratchpad
bindsym $mod+m move scratchpad
bindsym $mod+o scratchpad show

#automatic back-and-forth switch workspace
workspace_auto_back_and_forth yes


#generic
for_window [class="_popup-notitle-small-sticky"] border 1pixel, floating enable, resize set $wfS_width $wfS_height, move position center, sticky enable
for_window [class="_popup-notitle-medium-sticky"] border 1pixel, floating enable, resize set $wfM_width $wfM_height, move position center, sticky enable
for_window [class="_popup-notitle-large-sticky"] border 1pixel, floating enable, resize set $wfL_width $wfL_height, move position center, sticky enable
for_window [class="_popup-notitle-small"] border 1pixel, floating enable, resize set $wfS_width $wfS_height, move position center
for_window [class="_popup-notitle-medium"] border 1pixel, floating enable, resize set $wfM_width $wfM_height, move position center
for_window [class="_popup-notitle-large"] border 1pixel, floating enable, resize set $wfL_width $wfL_height, move position center
for_window [class="_popup-notitle"] border 1pixel, floating enable
for_window [class="_popup"] floating enable

#large, small and large borderless window popup
set $float_largeW_app Gpodder|Mpsyt|Modem-manager-gui|Nm-connection-editor|Mattermost|Signal|YouTube Music
set $float_smallW_app Pavucontrol|Blueberry.py
set $float_borderless_app Sxiv|YouTube Music
for_window [class="$float_largeW_app"] floating enable, resize set $wfL_width $wfL_height, move position center, sticky enable
#small window with no title bar (keep it small)
for_window [class="$float_smallW_app"] floating enable, resize set $wfM_width $wfM_height, move position center, border 1pixel, sticky enable
for_window [class="$float_borderless_app"]  floating enable, move position center, border 1pixel, sticky enable
for_window [instance="float_borderless_app"]  floating enable, move position center, border 1pixel, sticky enable

#no border
set $no_border Gpodder|Vimb|Alacritty|Gvim
for_window [class="$no_border"] border 1pixel, focus

# applications
for_window [class="Vimb"] border 1pixel, focus
for_window [title="uvim"] border 1pixel
for_window [class="URxvt"] border 1pixel
for_window [class="Alacritty"] border 1pixel
for_window [class="Gvim"] border 1pixel
for_window [title="filemanager"] border 1pixel, layout tabbed
for_window [title="JACK.*"] floating enable
for_window [title="Molotov"] floating enable, resize set $wfL_width $wfL_height, move position center, sticky enable, output $screen1
for_window [class="Deezer"] floating enable, border 1pixel, resize set $wfL_width $wfL_height, move position center, sticky enable, output $screen1
for_window [class="Caprine"] floating enable, resize set $wfL_width $wfL_height, border 1pixel, sticky enable, output $screen2;
for_window [title="pinentry"] floating enable
for_window [class="termite_dict"] floating enable, move position center, border 1pixel
for_window [title="david_adsnovo - Skype*"] focus, sticky enable, move right, resize shrink left 20 px or 20 ppt, layout splith;
for_window [title="Liste de contacts"] focus, sticky enable, move right, resize shrink left 20 px or 20 ppt, layout splith;
for_window [class="Cawbird"] resize set width 640 px;
for_window [title="^ [^ ]+$"] move --no-auto-back-and-forth container to workspace $menu1, focus
#for_window [title="La Quadrature du Net - Mastodon - Media Fédéré"] focus parent, sticky enable, move right, resize shrink left 20 px or 20 ppt, layout splith;
#for_window [title="Twitter"] move right; resize shrink left 30 px or 30 ppt;
#for_window [class="Vimb"] border 1pixel
#for_window [title="vim"] title_format "<span font='devicons'> </span>%title"

# assign app to dedicated workspace
assign [class="(pinta|Inkscape)"] graphic
for_window [class="(pinta|Inkscape)"] focus
assign [class="Pidgin"] pidgin
for_window [class="Pidgin"] focus
assign [class="Brave-browser"] $menu5
assign [class="Shotwell"] $menu6
#assign [class="Vimb"] $menu2 TODO see how to get exception for i.e. news app
#for_window [class="Vimb"] layout tabbed; focus
#assign [class="Urxvt"] terminal
#for_window [class="Urxvt"] layout splith; focus

#vimb with title starting by "scratchpad_" are moved to the scratch pad and show
#for_window [title="scratchpad_*"] sticky enable, border 1pixel;
#set $scratchpads skype|pidgin|iCloud|gPodder
for_window [title="$scratchpads"] [class="$scratchpads"] sticky enable, border 1pixel, move scratchpad, scratchpad show;
for_window [title="Franz"] sticky enable, border 1pixel, move scratchpad, resize set 720 874, scratchpad show, move absolute position 720px 24px;
for_window [title="scratchpad_ncmpcpp"] sticky enable, border 1pixel, move scratchpad, resize set $wfM_width  $wfM_height, scratchpad show;
for_window [title="scratchpad_cal"] sticky enable, border 1pixel, move scratchpad, scratchpad show;
for_window [title="skype"] sticky enable, border 1pixel, move scratchpad, scratchpad show;
for_window [title="N26"] sticky enable, border 1pixel, move scratchpad, resize set 500 820, scratchpad show, move position center;

for_window [title="pidgin"] sticky enable, border 1pixel, move scratchpad, scratchpad show;
for_window [class="Slack|Keybase|Whalebird"] sticky enable, border 1pixel, move scratchpad, resize set $wfM_width $wfM_height,  scratchpad show;
for_window [title="iCloud"] sticky enable, border 1pixel, move scratchpad, resize set $wfM_width  $wfM_height, scratchpad show, move position center;

client.focused #859900 #859900 #eee8d5 #859900
client.focused_inactive #073642 #073642 #586e75 #6c71c4
client.unfocused #073642 #073642 #93a1a1 #586e75
client.urgent #d33682 #d33682 #fdf6e3 #dc322f

set $Locker i3lock -i ~/.config/wallpaper/solarized-dark.png -c 002b36 && sleep 1

set $i3ctl i3 [r]eload re[s]tart restart [b]ar [e]xit
bindsym $mod+Shift+r mode "$i3ctl"
mode "$i3ctl" {
    # reload the configuration file
    bindsym r reload
    # restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
    bindsym s restart
    # exit i3 (logs you out of your X session)
    bindsym e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"
    # restart bar
    bindsym b exec pkill -SIGUSR1 -f "python $HOME/.config/i3/status.py", mode "default"


    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# resize mod window $mod+r (you can also use the mouse for that)
bindsym $mod+r mode "resize / move / [s]ticky / [bB]order / [c]enter / [f]loat right corner"
mode "resize / move / [s]ticky / [bB]order / [c]enter / [f]loat right corner" {

    bindsym h resize grow width 10 px or 10 ppt
    bindsym j resize grow height 10 px or 10 ppt
    bindsym k resize shrink height 10 px or 10 ppt
    bindsym l resize shrink width 10 px or 10 ppt
    bindsym s sticky toggle, mode "default"
    bindsym B border 1pixel, mode "default"
    bindsym b border normal, mode "default"
    bindsym f exec python3 -m i3grid snap --target 9 --rows 3 --cols 3, mode "default"
    #bindsym f floating enable, resize set $wfM_width $wfM_height, border 1pixel, sticky enable, mode "default"
    bindsym c move position center, mode "default"

    # same bindings, but for the arrow keys
    bindsym Left move left 10 px
    bindsym Down move down 10 px
    bindsym Up move up 10 px
    bindsym Right move right 10 px

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# Press $mod+o followed by either f, t, Esc or Return to launch firefox,
#  etc ... or return to the default mode, respectively.
set $mode_launcher Launch: [f]irefox [t]rello [s]lack [r]emmina [w]ork-env [W]riter
bindsym $mod+Shift+p mode "$mode_launcher"

mode "$mode_launcher" {

    bindsym f exec firefox, mode "default"
    bindsym t exec trello, mode "default"
    bindsym s exec slack, mode "default"
    bindsym r exec remmina, mode "default"
    bindsym w exec trello && sleep 1 && chrome && vimb && lbf && trèfle && slack && wikipe, mode "default"
    bindsym W exec writer, mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# Press $mod+Shift+c s or f to take a screen shot
set $mode_screenshot Screenshot [s]election [f]ullscreen
bindsym $mod+Shift+c mode "$mode_screenshot"

mode "$mode_screenshot" {

    #bindsym s exec maim --opengl --magnify -s ~/Desktop/screenshot-$(date +%F-%H%M%S).png, mode "default"
    bindsym s exec maim -s ~/Images/screenshot-$(date +%F-%H%M%S).png, mode "default"
    bindsym f exec maim ~/Images/screenshot-$(date +%F-%H%M%S).png, mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# file navigation with ranger
set $mode_filemanager Goto [h]ome [d]ownloads [s]hare [D]esktop
bindsym $mod+Shift+f mode "$mode_filemanager"

mode "$mode_filemanager" {

    bindsym h exec filemanager ~/., mode "default"
    bindsym d exec filemanager ~/downloads, mode "default"
    bindsym s exec filemanager ~/share, mode "default"
    bindsym Shift+d exec filemanager ~/Desktop, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

#USB mount file
set $mode_usbmount USB [m]ount or [u]mount
bindsym $mod+u mode "$mode_usbmount"
mode "$mode_usbmount" {
    bindsym m exec zsh -i -c 'mount-all-devices', mode "default"
    bindsym u exec zsh -i -c 'udiskie-umount /run/media/*/* && notify-send umount all', mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}


# system mode, hit power button to halt, suspend, reboot or shutdown
set $mode_system System [l] lock, [e] logout, [s] suspend, [h] hibernate, [r] reboot, [Shift]+[s] shutdown
bindsym Pause mode "$mode_system"
bindsym XF86Sleep mode "$mode_system"
bindsym XF86Eject mode "$mode_system"
bindsym XF86PowerOff mode "$mode_system"

mode "$mode_system" {

    bindsym l exec --no-startup-id $Locker, mode "default"
    bindsym e exec --no-startup-id i3-msg exit, mode "default"
    bindsym s exec --no-startup-id $Locker && systemctl suspend, mode "default"
    bindsym h exec --no-startup-id $Locker && systemctl hibernate, mode "default"
    bindsym r exec --no-startup-id systemctl reboot, mode "default"
    bindsym Shift+s exec --no-startup-id systemctl poweroff -i, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# mplayer control and mpd control
set $mode_player player: [Pp]ause/[Pp]lay [n]ext [Ss]eek [Qq]quit/stop
bindsym $mod+b mode "$mode_player"

mode "$mode_player" {

    bindsym p exec zsh -i -c 'echo "pause" > /tmp/mplayer', mode "default"
    bindsym Shift+p exec mpc toggle, mode "default"
    bindsym n exec zsh -i -c 'mpc next', mode "default"
    bindsym s exec zsh -i -c 'echo "seek 10" > /tmp/mplayer'
    bindsym Shift+s exec mpc seek +10
    bindsym q exec zsh -i -c 'echo "quit" > /tmp/mplayer && mpc stop', mode "default"
    bindsym Shift+q exec mpc stop, mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

#Toolbar shortcut
set $mode_toolbar [C]ointop | [w]eather | [n]cdu | [g]otop | [i]pfs | [S]yncthing | [u]pdate | [s]ound | [c]alendar
bindsym $capsLock+space mode "$mode_toolbar"
mode "$mode_toolbar" {
    #bindsym c exec zsh -i -c 'mount-all-devices', mode "default"
    #bindsym u exec zsh -i -c 'udiskie-umount /run/media/*/* && notify-send umount all', mode "default"
    bindsym Shift+c exec coin, mode "default"
    bindsym w exec popup wego, mode "default"
    bindsym n exec ncdu-i3, mode "default"
    bindsym g exec popup -s medium -e sudo gotop, mode "default"
    bindsym i exec toggle-ipfs, mode "default"
    bindsym Shift+s exec vimb http://127.0.0.1:8384, mode "default"
    bindsym u exec yay-i3, mode "default"
    bindsym s exec apptoggle pavucontrol, mode "default"
    bindsym c exec pal-i3, mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

#bindsym $capsLock+t exec [ $(pgrep -f '[a]lacritty --title scratchpad_pevimwiki') ] && alacritty --title scratchpad_pevimwiki -e vim share/vimwiki_boulot/index.wiki || i3-msg [title=scratchpad_pevimwiki] scratchpad show;
#bindsym $capsLock+w exec [ $(pgrep -cf '^alacritty --title scratchpad_vimwiki') -eq 0 ] && (alacritty --title scratchpad_vimwiki -e vim -c VimwikiIndex) || (i3-msg [title=scratchpad_vimwiki] scratchpad show)
set $ws_wiki -H 740 -W 670
#TODO test if only class is sufficient (delete title option)
bindsym $capsLock+w exec popup -h -t vimwiki $ws_wiki vim -c VimwikiIndex;
bindsym $capsLock+t exec popup -h -c work -t pevimwiki $ws_wiki vim share/vimwiki_boulot/index.wiki;
bindsym $capsLock+Shift+t exec task-i3
bindsym $capsLock+i exec popup -h -c perso -t persovimwiki $ws_wiki vim share/vimwiki_perso/index.wiki;
bindsym $capsLock+v exec popup -h -c vimconf -t vimconf $ws_wiki vim .vim/config;
#bindsym $capsLock+c exec [ $(pgrep -f '[/]usr/bin/franz-bin') ] && /usr/bin/franz-bin || i2-msg [title=Franz] scratchpad show;
bindsym $capsLock+m exec "popup -s 600x300 -p right,bottom -h -c music -t ncmpcpp -o font.size=5 -e ncmpcpp"
bindsym $capsLock+Shift+m exec popup -h -t mpsyt -e mpsyt
bindsym $capsLock+k exec stig-i3
bindsym $capsLock+p exec [ -z $( ps h -C gpodder -o comm=Command ) ] && gpodder || i3-msg [title=gPodder floating] scratchpad show;
bindsym $capsLock+r exec popup -h -t radio pyradio
bindsym $capsLock+e exec [ $(pgrep -f '[a]lacritty --title scratchpad_cal') ] && alacritty --title scratchpad_cal -e pal -m || i3-msg [title=scratchpad_cal] scratchpad show;
bindsym $capsLock+n exec i3-msg '[class="VirtualBox Machine"] scratchpad show' && i3-msg '[class="VirtualBox Machine"] fullscreen enable';
bindsym $capsLock+s exec i3-msg '[class="Slack"] scratchpad show';
bindsym $capsLock+Shift+s exec i3-msg '[class="Teams"] scratchpad show';
#bindsym $capsLock+w exec [ $( ps -eo cmd | grep -c '[t]ermite --title scratchpad_vimwiki' ) -eq 2 ] && termite --title scratchpad_vimwiki -e 'vim -c VimwikiIndex' || i3-msg kill;
#bindsym $capsLock+i exec [ $( ps -eo cmd | grep -c '[t]ermite --title scratchpad_vimdiary' ) -eq 2 ] && termite --title scratchpad_vimdiary -e 'vim -c VimwikiDiaryIndex' || i3-msg kill;
#bindsym $capsLock+v exec [ $( ps -eo cmd | grep -c '[t]ermite --title scratchpad_vimb' ) -eq 2 ] && termite --title scratchpad_vimb -e 'vim .config/vimb/config' || i3-msg kill;
#focus; move scratchpad; scratchpad show


# Enable/disable logging
#bindsym $mod+x shmlog toggle

# Screensaver
# exec xautolock -corners -00+ -time 4 -locker "funst --screen-saver"

# Background image
# see in xprofile
exec --no-startup-id blueberry-tray
exec --no-startup-id pcloud
exec --no-startup-id megasync


